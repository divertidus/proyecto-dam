<app-toolbar-logged [titulo]="'Mis Rutinas'"></app-toolbar-logged>

<ion-content>
  <!-- <h2>Mis Rutinas:</h2>
 -->
  <!-- Si no existen rutinas, mostrar un mensaje similar al de "sin entrenamientos" -->
  <ion-card *ngIf="rutinas.length === 0" class="no-rutina-card">
    <ion-card-header>
      <ion-card-title>No tienes rutinas creadas</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      Crea una nueva rutina para comenzar a organizar tus entrenamientos.
    </ion-card-content>
  </ion-card>

  <!-- Mostrar la lista de rutinas si existen -->
  <ion-list *ngIf="rutinas.length > 0">
    <ng-container *ngFor="let rutina of rutinas">
      <ion-card class="rutina-card">
        <ion-card-header (click)="toggleExpandirRutina(rutina)">
          <div class="header-rutina">
            <ion-card-title>{{ rutina.nombre }}</ion-card-title>
            <div class="iconos-header">
              <ion-icon name="pencil-outline" (click)="editarRutina(rutina, $event)"
                class="icono-cambiar-nombre"></ion-icon>
              <ion-icon name="close-outline" (click)="eliminarRutina(rutina, $event)"
                class="icono-eliminar-rutina"></ion-icon>
            </div>
          </div>
          <ion-card-subtitle>{{ rutina.dias.length }} días en esta rutina</ion-card-subtitle>
          <ion-card-subtitle *ngIf="rutina.descripcion">{{ rutina.descripcion }}</ion-card-subtitle>
          <ion-card-subtitle *ngIf="!rutina.descripcion">Sin descripción</ion-card-subtitle>
        </ion-card-header>

        <ion-card-content *ngIf="rutinaExpandida === rutina._id">
          <div class="dias-container">
            <ng-container *ngFor="let dia of rutina.dias">
              <div class="dia-container">
                <h3>{{ dia.diaNombre }} - {{ dia.descripcion }}</h3>
                <ion-button (click)="editarDiaRutina(rutina, dia)">Editar Día</ion-button>
                <ul>
                  <li *ngFor="let ejercicioPlan of dia.ejercicios">
                    {{ ejercicioPlan.nombreEjercicio }} - {{ ejercicioPlan.series }}x{{ ejercicioPlan.repeticiones }}
                  </li>
                </ul>
              </div>
            </ng-container>

            <div *ngIf="rutina.dias.length > 0" class="anadir-dia-container">
              <ion-button fill="outline" color="success" (click)="abrirFormularioDia(rutina)">
                <ion-icon name="add-circle-outline"></ion-icon> Añadir otro Día
              </ion-button>
            </div>
          </div>
        </ion-card-content>
      </ion-card>
    </ng-container>
  </ion-list>

  <!-- Botón para añadir una nueva rutina con el mismo estilo que "Comenzar a entrenar" -->
  <ion-button expand="block" size="large" class="boton-crear-nueva" (click)="crearNuevaRutina()">
    <ion-icon name="add-circle-outline"></ion-icon> Añadir Nueva Rutina
  </ion-button>
</ion-content>